language: java
jdk:
- oraclejdk8
before_install:
- |
  if ! git diff --name-only $TRAVIS_COMMIT_RANGE | grep -qvE '(.js)|(.txt)|(.md)|(.png)|(.pdf)|(.html)|^(LICENSE)|^(docs)'
  then
    echo "Only doc files were updated, not running the CI."
    exit
  fi
matrix:
  fast_finish: true
  include:
  - env: VERSION='-PhadoopVersion=2.4.0'
  - env: VERSION='-PhadoopVersion=2.6.1'
  - env: VERSION='-PhadoopVersion=2.7.0'
  - env: VERSION='-PhadoopVersion=2.8.0'
  - env: VERSION='-PhadoopVersion=2.9.0'
  - env: VERSION='-PhadoopVersion=3.0.0'
script:
- "./gradlew clean build buildRpm buildDeb $VERSION"
after_success:
- bash <(curl -s https://codecov.io/bash)
deploy:
  provider: releases
  api_key:
    secure: 0S6O1VLGDJgPjr113O02CVb/d8G72p1Qs1TZsrc/UNeCTugTVxHo8D5SUSZbToeKnDFBr3FSfzwyQuFwaGEi3IoqwWQsM0irk+uNG8qT21TtGKTRkl+CtD5Y9fP39H8tAOR+ErcI3kp/+AByTDe7DiMzvYBv3Sz8jcjSdDIfy2kxe3MOWPgVdHH0AVsr/YcftuxFcPOgJVCgMsVBnrbXu2QQwFdUP3TKCJriG71I8HkMaB38aEKRd5vgN1kBg31XbXzN+BagHDatX9zmOmFpnFf1W81hUZdM+K60caxlLyYfpy/Ni96yBAT7qN0ZoDVBjjPm66Q9Ji1h3ypEAfqLbvqZVVg+PwvrNkl9aCwZV5jGoJNaNNOyx5QqQoIDSxlqu1QtRYRngWzjNUEK/2kjwbzr1dnTBy/luB7spXGlbDB4Ws9WeTuB4hcO/V/8a2l+D7aQ65YomsoZqAVSER1urTq9jAHAEiI0YJe/zjhIwffw9/Yp8vpX1XG/TBXfOT4EfKs3WJZyNGHRsCLoekD8PsuHT5b3KqKJD3yDx6TrjFgEQeNchjT3Qx1Iexk+00fOFP6b3fcpwDiEBgChHVQ6ubwQJi+qhBaAxZ2zMhDs2gfddzwG3pFLGMoD74h7FSEZl1Ra7ZOwNn5lHyz+eRMBuRi84vRTVmM3rGJCvO+voyo=
  file: build/distributions/*
  skip_cleanup: true
  on:
    tags: true
    repo: paypal/NNAnalytics
